<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Arquivo completo de edi√ß√µes da newsletter Pro dia nascer Feliz">
    <title>Edi√ß√µes - Pro dia nascer Feliz</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="apple-touch-icon" href="favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Animated Sun Background -->
    <div class="sun-container">
        <svg class="sun-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <linearGradient id="sunGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#FF6B35;stop-opacity:1">
                        <animate attributeName="stop-color" values="#FF6B35;#FFD23F;#FF6B35" dur="8s" repeatCount="indefinite"/>
                    </stop>
                    <stop offset="100%" style="stop-color:#FF8C61;stop-opacity:1">
                        <animate attributeName="stop-color" values="#FF8C61;#FFEB99;#FF8C61" dur="8s" repeatCount="indefinite"/>
                    </stop>
                </linearGradient>
            </defs>
            <circle cx="100" cy="100" r="60" fill="url(#sunGradient)">
                <animate attributeName="r" values="60;65;60" dur="4s" repeatCount="indefinite"/>
            </circle>
            <g transform="translate(100, 100)">
                <g class="rays">
                    <line x1="0" y1="-80" x2="0" y2="-95" stroke="#FF6B35" stroke-width="3" stroke-linecap="round"/>
                    <line x1="56" y1="-56" x2="67" y2="-67" stroke="#FF6B35" stroke-width="3" stroke-linecap="round"/>
                    <line x1="80" y1="0" x2="95" y2="0" stroke="#FF6B35" stroke-width="3" stroke-linecap="round"/>
                    <line x1="56" y1="56" x2="67" y2="67" stroke="#FF6B35" stroke-width="3" stroke-linecap="round"/>
                    <line x1="0" y1="80" x2="0" y2="95" stroke="#FF6B35" stroke-width="3" stroke-linecap="round"/>
                    <line x1="-56" y1="56" x2="-67" y2="67" stroke="#FF6B35" stroke-width="3" stroke-linecap="round"/>
                    <line x1="-80" y1="0" x2="-95" y2="0" stroke="#FF6B35" stroke-width="3" stroke-linecap="round"/>
                    <line x1="-56" y1="-56" x2="-67" y2="-67" stroke="#FF6B35" stroke-width="3" stroke-linecap="round"/>
                    <animateTransform 
                        attributeName="transform" 
                        attributeType="XML" 
                        type="rotate" 
                        from="0" 
                        to="360" 
                        dur="60s" 
                        repeatCount="indefinite"/>
                </g>
            </g>
        </svg>
    </div>

    <div class="page-wrapper">
        <!-- Hero -->
        <header class="hero">
            <h1 class="title">
                <span class="title-line">Arquivo de</span>
                <span class="title-line accent">Edi√ß√µes</span>
            </h1>
            <p class="subtitle">Todas as newsletters j√° enviadas</p>
            <a href="/" class="hero-cta" style="display:inline-block;text-decoration:none;">
                ‚Üê Voltar para home
            </a>
        </header>

        <!-- Main Content -->
        <main class="content">
            <!-- User Status -->
            <section class="section">
                <div id="userStatus" style="text-align:center;padding:20px;background:rgba(255,107,53,0.08);border:1px solid rgba(255,107,53,0.2);border-radius:12px;margin-bottom:40px;color:#333;">
                    Carregando...
                </div>
            </section>

            <!-- Editions List -->
            <section class="section">
                <div id="editionsContainer">
                    <div style="text-align:center;padding:60px 20px;">
                        <div style="width:50px;height:50px;border:4px solid rgba(255,107,53,0.2);border-top-color:#FF6B35;border-radius:50%;margin:0 auto 20px;animation:spin 1s linear infinite;"></div>
                        <p style="color:#666;">Carregando edi√ß√µes...</p>
                    </div>
                </div>
            </section>

            <!-- CTA Section -->
            <section class="section cta-section" style="display:block;">
                <p class="cta-text">Curtiu? Receba todo dia no seu email</p>
                <a href="/" class="cta-button" style="display:inline-block;text-decoration:none;">
                    Quero me inscrever ‚Üí
                </a>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>¬© 2026 ‚Äî Todos os direitos reservados para Pro dia nascer Feliz ¬∑ <a href="/cdn-cgi/l/email-protection#c8a6adbfbbe6b8baa7aca1a9a6a9bbabadbaaeada4a1b288afa5a9a1a4e6aba7a5">Contato</a> ¬∑ <a href="privacidade.html">Privacidade</a></p>
        </footer>
    </div>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
        // Configura√ß√£o da API
        const API_URL = 'https://script.google.com/macros/s/AKfycbwhz4hBt1cAojHParJ5xuVs8JQdwaaYZOtVW3JO0YhMWkTG34wg4HUp754wEm2qOdZb/exec';

        // Checa autentica√ß√£o
        function checkAuth() {
            const token = localStorage.getItem('auth_token');
            const email = localStorage.getItem('user_email');
            
            if (token && email) {
                document.getElementById('userStatus').innerHTML = `
                    <span style="color:#10b981;font-weight:600;">‚úì Logado como <strong>${email}</strong></span>
                `;
                return { logged: true, email, token };
            } else {
                document.getElementById('userStatus').innerHTML = `
                    <span style="color:#333;">üîí Voc√™ precisa estar cadastrado para ler as edi√ß√µes. <a href="/" style="color:#FF6B35;text-decoration:underline;font-weight:600;">Cadastre-se gr√°tis</a></span>
                `;
                return { logged: false };
            }
        }

        // Carrega edi√ß√µes ‚Äî mostra mock imediatamente, atualiza quando API responder
        function loadEditions() {
            const auth = checkAuth();

            // Mostra mock IMEDIATAMENTE (sem esperar API)
            renderEditions(generateMockEditions(), auth.logged);

            // Tenta buscar da API via JSONP (evita CORS do Apps Script)
            const callbackName = 'editionsCallback_' + Date.now();
            const script = document.createElement('script');
            
            const timeout = setTimeout(() => {
                cleanup();
                console.warn('API timeout ‚Äî usando mock');
            }, 8000);

            window[callbackName] = function(data) {
                clearTimeout(timeout);
                cleanup();
                if (data && data.editions && data.editions.length > 0) {
                    renderEditions(data.editions, auth.logged);
                }
            };

            function cleanup() {
                if (script.parentNode) script.parentNode.removeChild(script);
                delete window[callbackName];
            }

            script.onerror = function() {
                clearTimeout(timeout);
                cleanup();
            };

            script.src = `${API_URL}?action=list&callback=${callbackName}`;
            document.head.appendChild(script);
        }

        // Mock de edi√ß√µes (fallback / conte√∫do inicial enquanto API carrega)
        function generateMockEditions() {
            const editions = [];
            const today = new Date();
            const previews = [
                'Thread viral sobre IA no trabalho, bastidores do Congresso, o que a m√≠dia n√£o contou...',
                'Meme do dia, crise nos bastidores de uma grande empresa, conspira√ß√£o econ√¥mica...',
                'Trend do TikTok, o que aconteceu nos bastidores da pol√≠tica, segredo revelado...',
                'Viral das redes, bastidores de celebridade, not√≠cia que ningu√©m explicou direito...',
                'Thread sobre mercado financeiro, fofoca corporativa, conspira√ß√£o do dia...',
                'O que viralizou ontem, bastidores do esporte, segredo de bastidor...',
                'Trend surpresa, o que a imprensa omitiu, fofoca do mundo corporativo...',
            ];
            
            for (let i = 0; i < 7; i++) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                
                const dateStr = date.toISOString().split('T')[0];
                const displayDate = date.toLocaleDateString('pt-BR', { 
                    day: 'numeric', 
                    month: 'long',
                    year: 'numeric'
                });
                
                editions.push({
                    date: dateStr,
                    displayDate: displayDate,
                    title: i === 0 ? 'Edi√ß√£o de Hoje' : `Edi√ß√£o de ${date.getDate()} de ${date.toLocaleDateString('pt-BR', {month: 'long'})}`,
                    preview: previews[i % previews.length],
                    topics: ['Viralizando', 'Conspira√ß√£o', 'Bastidores']
                });
            }
            
            return editions;
        }

        // Renderiza edi√ß√µes
        function renderEditions(editions, isLogged) {
            const container = document.getElementById('editionsContainer');
            
            const html = editions.map((edition, index) => `
                <div class="value-card" onclick="openEdition('${edition.date}', ${isLogged})" style="cursor:pointer;transition:transform 0.2s;">
                    <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:12px;">
                        <div class="card-emoji" style="font-size:32px;">${index === 0 ? 'üì∞' : 'üìÖ'}</div>
                        ${!isLogged ? '<span style="font-size:24px;opacity:0.3;">üîí</span>' : ''}
                    </div>
                    <h3 class="card-title">${edition.title}</h3>
                    <p style="font-size:13px;color:#999;margin-bottom:12px;">${edition.displayDate}</p>
                    <p class="card-desc">${edition.preview}</p>
                    ${edition.topics ? `
                        <div style="display:flex;gap:8px;margin-top:16px;flex-wrap:wrap;">
                            ${edition.topics.map(t => `<span style="padding:4px 12px;background:#f5f5f5;border-radius:6px;font-size:11px;font-weight:600;color:#666;">${t}</span>`).join('')}
                        </div>
                    ` : ''}
                </div>
            `).join('');
            
            container.innerHTML = `<div class="value-grid-new">${html}</div>`;
            
            // Adiciona hover effect
            document.querySelectorAll('.value-card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-4px)';
                });
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });
        }

        // Modal de verifica√ß√£o de email
        function openEdition(date, isLogged) {
            // Se j√° est√° logado, vai direto
            if (isLogged) {
                window.location.href = `/edicoes/${date}.html`;
                return;
            }

            // Mostra modal de email
            const modal = document.createElement('div');
            modal.id = 'emailModal';
            modal.style.cssText = `
                position:fixed;top:0;left:0;width:100%;height:100%;
                background:rgba(0,0,0,0.6);z-index:9999;
                display:flex;align-items:center;justify-content:center;
                padding:20px;box-sizing:border-box;
            `;
            modal.innerHTML = `
                <div style="background:#fff;border-radius:20px;padding:40px;max-width:420px;width:100%;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.3);">
                    <div style="font-size:48px;margin-bottom:16px;">‚òÄÔ∏è</div>
                    <h2 style="font-size:22px;font-weight:900;margin-bottom:8px;color:#111;">Qual √© o seu email?</h2>
                    <p style="color:#666;font-size:14px;margin-bottom:24px;">Digite o email que voc√™ usou para se cadastrar</p>
                    
                    <input 
                        type="email" 
                        id="modalEmail" 
                        placeholder="seu@email.com"
                        style="width:100%;padding:14px 16px;border:2px solid #eee;border-radius:12px;font-size:16px;outline:none;box-sizing:border-box;margin-bottom:12px;font-family:Inter,sans-serif;"
                        onkeypress="if(event.key==='Enter') verifyEmail('${date}')"
                        onfocus="this.style.borderColor='#FF6B35'"
                        onblur="this.style.borderColor='#eee'"
                    />
                    
                    <div id="modalMsg" style="min-height:20px;font-size:13px;margin-bottom:16px;"></div>
                    
                    <button 
                        onclick="verifyEmail('${date}')"
                        style="width:100%;padding:16px;background:#111;color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:700;cursor:pointer;font-family:Inter,sans-serif;margin-bottom:12px;"
                        onmouseover="this.style.background='#FF6B35'"
                        onmouseout="this.style.background='#111'"
                    >
                        Acessar edi√ß√£o ‚Üí
                    </button>
                    
                    <button 
                        onclick="document.getElementById('emailModal').remove()"
                        style="background:none;border:none;color:#999;font-size:13px;cursor:pointer;font-family:Inter,sans-serif;"
                    >
                        Cancelar
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Foca no input automaticamente
            setTimeout(() => document.getElementById('modalEmail').focus(), 100);
            
            // Fecha ao clicar fora
            modal.addEventListener('click', function(e) {
                if (e.target === modal) modal.remove();
            });
        }

        // Verifica email na API
        async function verifyEmail(date) {
            const emailInput = document.getElementById('modalEmail');
            const msgEl = document.getElementById('modalMsg');
            const email = emailInput.value.trim().toLowerCase();
            
            if (!email || !email.includes('@')) {
                msgEl.style.color = '#e53e3e';
                msgEl.textContent = '‚ö†Ô∏è Digite um email v√°lido';
                return;
            }
            
            msgEl.style.color = '#666';
            msgEl.textContent = 'üîç Verificando...';
            
            try {
                // Verifica via JSONP
                const callbackName = 'checkCallback_' + Date.now();
                const script = document.createElement('script');
                
                const timeout = setTimeout(() => {
                    script.remove();
                    delete window[callbackName];
                    // Se API falhar, libera mesmo assim (fallback generoso)
                    liberarAcesso(email, date);
                }, 6000);
                
                window[callbackName] = function(data) {
                    clearTimeout(timeout);
                    script.remove();
                    delete window[callbackName];
                    
                    if (data && data.isSubscriber) {
                        liberarAcesso(email, date);
                    } else {
                        msgEl.style.color = '#e53e3e';
                        msgEl.textContent = '‚ùå Email n√£o encontrado. Voc√™ j√° se cadastrou?';
                        setTimeout(() => {
                            document.getElementById('emailModal').remove();
                            window.location.href = '/';
                        }, 2500);
                    }
                };
                
                script.src = `${API_URL}?action=check&email=${encodeURIComponent(email)}&callback=${callbackName}`;
                document.head.appendChild(script);
                
            } catch(e) {
                liberarAcesso(email, date);
            }
        }

        // Libera acesso e salva no localStorage
        function liberarAcesso(email, date) {
            localStorage.setItem('user_email', email);
            localStorage.setItem('auth_token', 'auth_' + Date.now());
            
            const msgEl = document.getElementById('modalMsg');
            if (msgEl) {
                msgEl.style.color = '#10b981';
                msgEl.textContent = '‚úÖ Acesso liberado! Abrindo edi√ß√£o...';
            }
            
            setTimeout(() => {
                window.location.href = `/edicoes/${date}.html`;
            }, 800);
        }

        // Carrega ao abrir
        loadEditions();
    </script>

    <style>
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</body>
</html>